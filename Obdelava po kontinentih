# Ustvari prazen set za shranjevanje unikatnih imen držav
#drzave = set()

# Preberi csv datoteko in zberi imena držav
#with open('cyber_data.csv', 'r') as file:
#    next(file)  # preskoči prvo vrstico, če vsebuje glavo
#    for vrstica in file:
#        podatki = vrstica.strip().split(',')
#        drzava = podatki[1]
#        drzave.add(drzava)

# Zapiši v nov txt file, eno državo na vrstico
#with open('drzave.txt', 'w') as izhod:
#    for drzava in drzave:
#        izhod.write(drzava + '\n')


###########
#import country_converter as coco

# Inicializiraj pretvornik
#cc = coco.CountryConverter()

# Preberi države iz txt datoteke
#with open('drzave.txt', 'r', encoding='utf-8') as file:
#    drzave = [vrstica.strip() for vrstica in file]

# Ustvari slovar: država -> kontinent
#drzava_kontinent = {}
#for drzava in drzave:
#    kontinent = cc.convert(names=drzava, to='continent')
#    if kontinent == 'not found':
#        kontinent = 'Neznano'
#    drzava_kontinent[drzava] = kontinent

# Shrani slovar v .py datoteko kot Python spremenljivko
#with open('drzave_kontinenti.py', 'w', encoding='utf-8') as out_file:
#    out_file.write(f"drzava_kontinent = {drzava_kontinent}")
########
import pandas as pd
import country_converter as coco

# Inicializiraj pretvornik
cc = coco.CountryConverter()

# Preberi CSV datoteko
df = pd.read_csv('cyber_data.csv')

# Funkcija za določitev kontinenta
def doloci_kontinent(drzava):
    if drzava == 'Virgin Islands':
        return 'North America'
    else:
        kontinent = cc.convert(names=drzava, to='continent')
        return kontinent if kontinent != 'not found' else 'Neznano'

# Določi kontinent za vsako državo
df['Continent'] = df['Country'].apply(doloci_kontinent)

# Stolpci za seštevek: vsi razen tistih, ki se začnejo z 'Rank', ter 'Attack-Date', 'Country', 'Continent'
stolpci_za_seštevek = [col for col in df.columns if not col.startswith('Rank') and col not in ['Country', 'Continent']]

# Združi po kontinentu in seštej izbrane stolpce
rezultat = df.groupby('Continent')[stolpci_za_seštevek].sum()

# Izpiši rezultat
print(rezultat)

# (Po želji) Shrani rezultat v CSV
rezultat.to_csv('sumirani_podatki_po_kontinentu.csv')
